<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Vote Visual</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="frame">
    <div class="container">
      <div class="bars-section">
        <div class="bar-wrapper">
          <div class="bar-container">
            <div id="bar-red" class="bar-text">ðŸ‡¨ðŸ‡¦ðŸ‡ºðŸ‡¸ CAN/U.S.</div>
            <div id="bar-red-fill" class="bar-fill red"></div>
            <div id="count-red" class="count">0</div>
            <div id="percent-red" class="percentage">0%</div>
          </div>
        </div>
        <div class="bar-wrapper">
          <div class="bar-container">
            <div id="bar-blue" class="bar-text">ðŸ‡¬ðŸ‡§ UK</div>
            <div id="bar-blue-fill" class="bar-fill blue"></div>
            <div id="count-blue" class="count">0</div>
            <div id="percent-blue" class="percentage">0%</div>
          </div>
        </div>
        <div class="bar-wrapper">
          <div class="bar-container">
            <div id="bar-green" class="bar-text">ðŸ‡¦ðŸ‡ºðŸ‡³ðŸ‡¿ AUS/NZ</div>
            <div id="bar-green-fill" class="bar-fill green"></div>
            <div id="count-green" class="count">0</div>
            <div id="percent-green" class="percentage">0%</div>
          </div>
        </div>
        <div class="bar-wrapper">
          <div class="bar-container">
            <div id="bar-yellow" class="bar-text">ðŸ‡ªðŸ‡º EURO</div>
            <div id="bar-yellow-fill" class="bar-fill yellow"></div>
            <div id="count-yellow" class="count">0</div>
            <div id="percent-yellow" class="percentage">0%</div>
          </div>
        </div>
      </div>

      <div class="pie-section">
        <svg id="piechart" viewBox="0 0 300 300"></svg>
      </div>
    </div>
  </div>

  <script>
    const votesUrl = 'https://script.google.com/macros/s/AKfycbzv5LQFZ2Dj2x4OMQZr1o20acXoN4DCy8Vez7oxc1A8T0hCGBK5EqHusXWxq7yIgY21Pw/exec';
    const colors = {
      red: ['#ff4d4d', '#b30000'],
      blue: ['#4da6ff', '#004080'],
      green: ['#66ff66', '#006600'],
      yellow: ['#ffe066', '#cc9900']
    };

    const keys = ['votered', 'voteblue', 'votegreen', 'voteyellow'];

    async function fetchVotes() {
      try {
        const response = await fetch(votesUrl);
        if (!response.ok) throw new Error('Network error');
        const votes = await response.json();
        updateBars(votes);
        updatePie(votes);
      } catch (error) {
        console.error('Fetch error:', error);
      }
    }

    function updateBars(votes) {
      const maxVotes = Math.max(...Object.values(votes), 1);
